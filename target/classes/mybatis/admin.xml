<?xml version="1.0" encoding="UTF-8"?>
 
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="admin"> <!-- 테이블명 사용 -->

<!-- 관리자 등록 -->
  <insert id="create" parameterType = "adminVO">
    INSERT INTO admin(adminno, a_name, a_nickname, a_email, a_passwd, 
                                a_age, a_act, rdate)
    VALUES ((SELECT NVL(MAX(adminno), 0)+1 as adminno FROM admin),
                #{a_name}, #{a_nickname}, #{a_email}, #{a_passwd}, #{a_age}, #{a_act}, sysdate)
  </insert>
  
<!-- 관리자 email 중복검사 -->
  <select id="checkEmail" resultType="int" parameterType="String">
    SELECT COUNT(a_email) as cnt
    FROM admin
    WHERE a_email=#{a_email}
  </select>
  
<!-- 관리자 nickname 중복검사 -->
  <select id="checkNickname" resultType="int" parameterType="String">
    SELECT COUNT(a_nickname) as cnt
    FROM admin
    WHERE a_nickname=#{a_nickname}
  </select>
  
<!-- 관리자 목록 -->
  <select id="list" resultType = "adminVO">
    SELECT adminno, a_name, a_nickname, a_email, a_passwd, 
              a_age, a_act, rdate
    FROM admin
    ORDER BY adminno ASC
  </select>
  
<!-- 관리자 조회 -->
  <select id="read" resultType="adminVO" parameterType="int">
    SELECT adminno, a_name, a_nickname, a_email, a_passwd, a_age, a_act, rdate
    FROM admin
    WHERE adminno = #{adminno}
  </select>
  
<!-- 관리자 조회 -->
  <select id="readByEmail" resultType="adminVO" parameterType="String">
    SELECT adminno, a_name, a_nickname, a_email, a_passwd, a_age, a_act, rdate
    FROM admin
    WHERE a_email = #{a_email}
  </select>
  
<!-- 관리자 수정 -->
  <update id="update" parameterType="adminVO"> 
    UPDATE admin 
    SET a_name = #{a_name}, a_email = #{a_email}, a_age = #{a_age}
    WHERE adminno = #{adminno}
  </update>
  
<!-- 패스워드 변경 -->
   <update id="passwd_update" parameterType="HashMap">
    UPDATE admin
    SET a_passwd = #{a_passwd}
    WHERE adminno = #{adminno}    
  </update>  
  
<!-- 관리자 삭제 -->
  <delete id="delete" parameterType="int">
  DELETE FROM admin
  WHERE adminno = #{adminno} 
  </delete>

<!-- 로그인 -->
  <select id="login" resultType="int" parameterType="Map">
    SELECT COUNT(adminno) as cnt
    FROM admin
    WHERE a_email = #{a_email} AND a_passwd=#{a_passwd}
  </select>
  
  
</mapper>